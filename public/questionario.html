<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Seu perfil</title>

    <script src="./js/sessao.js"></script>
    <link rel="stylesheet" href="css/styleuser.css">
</head>
<body>
    <div class="pai">
        <div class="header">
          <div class="container">
            <ul class="navbar">
               <div>
                <a href="indexUser.html"> <img class="imguser" src="img/account_avatar_face_man_people_profile_user_icon_123197.svg" alt="" class="logo"></a>
               </div>
               <div class="menuhamburguer">
                <li>
                  <a href="Questionario.html">Questionario</a>
                </li>
                <li>
                  <a href="Aulas.html">Aulas</a>
                </li>
                <li>
                  |
                </li>
                <li>
                  <a href="index.html">SAIR</a>
                </li>
               </div>  
            </ul>
          </div>
        </div>
      </div>


      <div style="display: flex; flex-direction: column; justify-content: center; align-items: center; padding-top: 80px;">

        <div class="div_mensagem">
          <h2>Sobre o questionário</h2>
          <p class="plogin">Respondendo o seguinte questionário você irá conseguir 
            saber qual o instrumento que mais se adequa ao seu perfil de acordo com suas características pessoais 
            dessa forma você pode começar algumas aulas básicas de música para depois buscar alguma escola de música.
            Espero que você goste!
            <button style="display: flex; justify-content: center; align-items: center; background-color: white; border: none; font-size: x-large; "><a href="#questio">▼</a></button>
          </p>
        </div>

        <div class="questio" id="questio">
          <h1 style="text-align: center;">Questionario</h1>
          <div class="pergunta">
            <label for="">Suas ações são baseadas em:</label><br>
            <select name="" id="select_resposta"> 
              <option value="#">Selecione</option>
              <option value="1">Suas emoções</option>
              <option value="2">Suas ideias</option>
            </select>
          </div>
         
          <div class="pergunta">
            <label for="">Você se considera uma pessoa:</label><br>
            <select name="" id="select_resposta1"> <option value="#">Selecione</option> 
              <option value="1">Clássica</option>
              <option value="2">Moderna</option>
            </select>
          </div>
  
          <div class="pergunta">
            <label for="">Qual seu genêro musical favorito:</label><br>
            <select name="" id="select_resposta2"> 
              <option value="#">Selecione</option>
              <option value="1">Sertanejo</option>
              <option value="2">MPB</option>
              <option value="3">POP</option>
              <option value="4">Clássica</option>
            </select>
          </div>
  
          <div class="pergunta">
            <label for="">Você costuma perder a paciência com facilidade:</label><br>
            <select name="" id="select_resposta3"> 
              <option value="#">Selecione</option>
              <option value="1">Sim</option>
              <option value="2">Não</option>  
              <option value="3">Ás vezes</option>
            </select>
          </div>
  
          <div class="pergunta">
            <label for="">Qual a sua reação quando algo em que se dedicou da errado: </label><br>
            <select name="" id="select_resposta4"> 
              <option value="#">Selecione</option>
              <option value="1">Refaço quantas vezes for preciso até dar certo</option>
              <option value="2">Tento novamente, mas se der errado, desisto</option>
              <option value="3">Prefiro não insistir em algo que não vale a pena</option>
              <option value="4">Desisto e fico muito mal</option>
            </select>
          </div>
  
          <div class="pergunta">
            <label for="">Qual dessas décadas você mais gosta:</label><br>
            <select name="" id="select_resposta5"> 
              <option value="#">Selecione</option>
              <option value="1">Anos 2000</option>
              <option value="2">Anos 90</option>
              <option value="3">Anos 80</option>
              <option value="4">Anos 70</option>
              <option value="5">Anos 60</option>
            </select>
          </div>
  
          <div class="pergunta">
            <label for="">Você costuma demonstrar seus sentimentos:</label><br>
            <select name="" id="select_resposta6">
              <option value="#">Selecione</option>  
              <option value="1">Sim</option>
              <option value="2">Não</option>
              <option value="3">Mais ou menos</option>
            </select>
          </div> 

          <button style="background-color: rgb(144, 106, 179); width: 25%; padding: 7px; border-radius: 5px; color: white;" onclick="enviar()">Enviar</button>
        </div>

        <div id="div_msg_questio" style="display: flex; width: 30%;
        height: 5%;
        font-size: large;
        align-items: center;
        display: flex;
        padding: 15px;
        margin-top: 20px;
        flex-direction: column;
        text-align: center;
        justify-content:center ; 
        margin-bottom: 20px; 
        background-color: rgb(206, 182, 228);"> </div>
      </div> 
    </div>
    <div id="div_aguardar" class="loading-div">
    </div>

      <script>
        var valido = false
        var pontuacao = 0
        var instrumento = ''

        function enviar() {

          var select1 = select_resposta1.value
          var select2 = select_resposta2.value
          var select3 = select_resposta3.value
          var select4 = select_resposta4.value
          var select5 = select_resposta5.value
          var select6 = select_resposta6.value

          if (select1 == '#' || select2 == '#' || select3 == '#' || select4 == '#' || select5 == '#' || select6 == '#') {
            alert('Preencha todos os campos do questionário')
          } else {
         
              // Definindo as pontuações com base nas respostas
              if (select1 == '1') {
            pontuacao += 1;
          } else {
            pontuacao += 2;
          }

          if (select2 == '1') {
            pontuacao += 1;
          } else {
            pontuacao += 2;
          }

          if (select3 == '1') {
            pontuacao += 2;
          } else if (select3 == '2') {
            pontuacao += 1;
          } else if (select3 == '3') {
            pontuacao += 2;
          } else {
            pontuacao += 1;
          }

          if (select4 == '1') {
            pontuacao += 1;
          } else if (select4 == '2') {
            pontuacao += 2;
          } else {
            pontuacao += 4;
          }

          if (select5 == '1') {
            pontuacao += 1;
          } else if (select5 == '2') {
            pontuacao += 2;
          } else if (select5 == '3') {
            pontuacao += 1;
          } else {
            pontuacao += 2;
          }

          if (select6 == '1') {
            pontuacao += 1;
          } else if (select6 == '2') {
            pontuacao += 1;
          } else {
            pontuacao += 2;
          }

          if (pontuacao == 6 || pontuacao == 7) {
             instrumento = 'violão';
          } else if (pontuacao == 8 || pontuacao == 9) {
            instrumento = 'bateria'
          } else if (pontuacao == 10 || pontuacao == 11) {
            instrumento = 'violino'
          } else { 
            instrumento = 'piano'
          }
          
          div_msg_questio.innerHTML = 'O instrumento recomendado para você é: ' + instrumento

          cadastrar();
        }


        function cadastrar() { 
        aguardar();

    //Recupere o valor da nova input pelo nome do id
    // Agora vá para o método fetch logo abaixo

    // Enviando o valor da nova input
    fetch("/aquarios/cadastrar", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
      },
      body: JSON.stringify({
        // crie um atributo que recebe o valor recuperado aqui
        // Agora vá para o arquivo routes/usuario.js
        pontuacaoServer: pontuacao,
        instrumentoServer: instrumento,
      }),
    })
      .then(function (resposta) {
        console.log("resposta: ", resposta);

        if (resposta.ok) {
         alert("Cadastro realizado com sucesso! Redirecionando para tela de Login...")

          setTimeout(() => {
            window.location = "indexUser.html";
          }, "1000");

          limparFormulario();
          finalizarAguardar();
        } else {
          throw "Houve um erro ao tentar realizar o cadastro!";
        }
      })
      .catch(function (resposta) {
        console.log(`#ERRO: ${resposta}`);
        finalizarAguardar();
      });

    return false;
  }
}
        
      </script>
</body>
</html>